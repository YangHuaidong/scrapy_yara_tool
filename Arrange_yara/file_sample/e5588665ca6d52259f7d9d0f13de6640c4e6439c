透过ASP修改NT使用者的密码


使用者登入C制在未淼木W_l@得越碓街匾, 很蔚牡览, 因楝F在的W站很著急的要做好T管理, 然後向T收X, 其@是很正常的代I, 台车墓司法f的很清楚嘛, 『公司以I利槟康摹 

在 IIS 5.0 的安全性身分CC制中, 整合的 Windows C (在 IIS 4.0 做 Windows NT 挑鹋c回) 是一不歹的x, 很蔚囊方法就可以_到一定水实陌踩性, 而且可以整合 Windows 2000 的使用者, 不^有一好o珊, 缺c是]有一很好的上更改密aC制, 所以今天就要斫榻B如何透^ ASP 砀改 NT 使用者密a 





HTML 部分 

一使用者登入你W站的安全^域, 你就可以利用 ServerVariables 集合中的 LOGIN_USER 砹私獾侨氲氖褂谜ぬ, 然得要把允S匿名登入xP], F在就先砜 HTML 部分 

<form action="changepwd.asp" method="post"> 
<!-- 榱瞬蛔使用者自己入ぬ所以使用[藏 --> 
<input type="hidden" name="UserName" 
    value="<%=Request.ServerVariables("LOGIN_USER")%>"> 
  <br>入f密a : <input name="OldPwd"> 
  <br>入新密a : <input name="NewPwd1"> 
  <br>_J新密a : <input name="NewPwd2"> 
  <input type="submit" value=" 更密a "> 
</form> 

程式a 

接下硎 ASP 的部分, 看看如何透^ ADSI 硇薷 WIndows 2000 使用者ぬ, ⑾碌椎某淌酱a存成 changepwd.asp n名 

<% 
OldPwd = Request.Form("OldPwd") 
NewPwd1 = Request.Form("NewPwd1") 
NewPwd2 = Request.Form("NewPwd2") 
UserName = Request.Form("UserName") 
  
If NewPwd1 = NewPwd2 Then 
  Set oUser = GetObject("WinNT://ComputerName/" & UserName) 
  oUser.ChangePassword OldPwd, NewPwd1 
  oUser.SetInfo 
  Set oUser = Nothing 
Else 
  Response.Write "再_J你的密a" 
End If 
%> 

希望@篇文章δ阌椭! 


