rule malware_sakula_xorloop {
  meta:
    author = "Spider"
    comment = "None"
    date = "None"
    description = "XOR loops from Sakula malware"
    family = "None"
    hacker = "None"
    judge = "black"
    md5 = "fc6497fe708dbda9355139721b6181e7"
    reference = "None"
    threatname = "None"
    threattype = "None"
  strings:
    $mz = "MZ"
    $opcodes_decode_loop01 = { 31 c0 8a 04 0b 3c 00 74 09 38 d0 74 05 30 d0 88 04 0b }
    $opcodes_decode_loop02 = { 8B 45 08 8D 0C 02 8A 01 84 C0 74 08 3C ?? 74 04 34 ?? 88 01 }
  condition:
    $mz at 0 and any of ($opcodes*)
}